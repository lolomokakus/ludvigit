#!/usr/bin/env bash

LANGUAGES=(da de el en es fi fr is it ja ko nl no pl ru sv zh-CN)
DEFAULTLANG=en
ENGINE=bing
PASSES=30
DELAY=2
VERBOSE=false

if [[ -z "$1" ]] ; then
  STRING="Please enter a string to make nonsense out of."
else
  STRING="$1"
fi

echo "$STRING"

if [[ -z "$2" ]] ; then
	originalLanguage=$DEFAULTLANG
else
	originalLanguage="$2"
fi

pass=0
while [[ $pass -lt $PASSES ]] ; do
  selectedLanguage=$((RANDOM % ${#LANGUAGES[@]} - 1))
  STRING=$(trans -engine $ENGINE -brief -no-autocorrect "$originalLanguage":${LANGUAGES[$selectedLanguage]} -- "$STRING")
  STRING=$(trans -engine $ENGINE -brief -no-autocorrect ${LANGUAGES[$selectedLanguage]}:"$originalLanguage" -- "$STRING")
  if [[ $VERBOSE = true ]] ; then
    echo "$STRING"
  else
    echo -n "."
  fi
  ((pass++))
  if [[ $pass -ne $PASSES ]] ; then
    sleep $DELAY
  fi
done

if [[ $VERBOSE = false ]] ; then
  echo
  echo "$STRING"
fi

exit 0
